---
import { ProductsSchema } from "@/types";
import ProductItem from "@/components/products/ProductItem.astro";
import ShowOrderButton from "../orders/ShowOrderButton";

const { category } = Astro.params;
const url = `${import.meta.env.API_URL}/freshcoffee_products?freshcoffee_category_slug=${category}&per_page=20`;
const response = await fetch(url);
const data = await response.json();
const products = ProductsSchema.parse(data);
---

<div class="flex items-center justify-between">
    <h1 class="text-2xl my-10">Elige y personaliza tu pedido a continuaci√≥n</h1>
    <ShowOrderButton client:only="react" />
</div>
<div
    class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-5 items-stretch"
>
    {products.map((product) => <ProductItem product={product} />)}
</div>
